<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dementia Early Detection</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f7fb;
  margin:0;
}
.container{
  max-width:420px;
  margin:auto;
  padding:15px;
}
.card{
  background:#fff;
  border-radius:15px;
  padding:20px;
  box-shadow:0 5px 15px rgba(0,0,0,0.1);
  margin-bottom:15px;
}
button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  background:#58cc02;
  color:#fff;
  font-size:16px;
  margin-top:10px;
}
input, select{
  width:100%;
  padding:10px;
  margin-top:8px;
  border-radius:8px;
  border:1px solid #ccc;
}
.hidden{display:none;}
.question img{
  width:100px;
  margin:10px 0;
}
.lang{
  text-align:right;
}
.lang button{
  width:auto;
  padding:6px 10px;
  background:#1cb0f6;
  margin-left:5px;
}
</style>
</head>

<body>
<div class="container">

<div class="lang">
<button onclick="setLang('en')">English</button>
<button onclick="setLang('kn')">ಕನ್ನಡ</button>
</div>

<!-- GUARDIAN LOGIN -->
<div class="card" id="guardianCard">
<h3 id="gTitle">Guardian Details</h3>
<input id="gName" placeholder="Guardian Name">
<input id="gAge" placeholder="Age" type="number">
<input id="gPhone" placeholder="Mobile Number">
<input id="gCountry" placeholder="Country">
<button onclick="saveGuardian()">Continue</button>
</div>

<!-- TEST -->
<div class="card hidden" id="testCard">
<h3 id="tTitle">Memory Test</h3>
<div id="questionBox"></div>
<button onclick="nextQuestion()">Next</button>
</div>

<!-- RESULT -->
<div class="card hidden" id="resultCard">
<h3 id="rTitle">Result</h3>
<p id="scoreText"></p>
<canvas id="chart" width="300" height="150"></canvas>
<button onclick="startTest()">Retake Test</button>
</div>

</div>

<script>
let lang="en";
let qIndex=0;
let score=0;

const text={
en:{
gTitle:"Guardian Details",
tTitle:"Memory Test",
rTitle:"Result",
},
kn:{
gTitle:"ಪಾಲಕರ ವಿವರಗಳು",
tTitle:"ಸ್ಮರಣೆ ಪರೀಕ್ಷೆ",
rTitle:"ಫಲಿತಾಂಶ",
}
};

const questions=[
{q:{en:"What is your son's name?",kn:"ನಿಮ್ಮ ಮಗನ ಹೆಸರು?"},options:["Ravi","Amit","Suresh"],ans:0},
{q:{en:"Which city do you live in?",kn:"ನೀವು ಯಾವ ನಗರದಲ್ಲಿ ವಾಸಿಸುತ್ತೀರಿ?"},options:["Delhi","Bengaluru","Mumbai"],ans:1},
{q:{en:"Identify this object",kn:"ಈ ವಸ್ತುವನ್ನು ಗುರುತಿಸಿ"},img:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/Red_Apple.jpg/120px-Red_Apple.jpg",options:["Apple","Ball","Orange"],ans:0},
{q:{en:"What day is today?",kn:"ಇಂದು ಯಾವ ದಿನ?"},options:["Monday","Tuesday","Sunday"],ans:2},
{q:{en:"Which animal barks?",kn:"ಯಾವ ಪ್ರಾಣಿ ಭೋಂ ಎನ್ನುತ್ತದೆ?"},options:["Cat","Dog","Cow"],ans:1},
{q:{en:"Identify this",kn:"ಇದನ್ನು ಗುರುತಿಸಿ"},img:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/India_flag_300.png/120px-India_flag_300.png",options:["India","USA","UK"],ans:0},
{q:{en:"How many fingers in one hand?",kn:"ಒಂದು ಕೈಯಲ್ಲಿ ಎಷ್ಟು ಬೆರಳುಗಳು?"},options:["4","5","6"],ans:1},
{q:{en:"What comes after 9?",kn:"9 ನಂತರ ಏನು ಬರುತ್ತದೆ?"},options:["10","11","8"],ans:0},
{q:{en:"Which season is cold?",kn:"ಯಾವ ಋತು ಚಳಿಯಾಗಿದೆ?"},options:["Summer","Winter","Rainy"],ans:1},
{q:{en:"What is this color?",kn:"ಈ ಬಣ್ಣ ಏನು?"},options:["Red","Blue","Green"],ans:1}
];

function setLang(l){
lang=l;
document.getElementById("gTitle").innerText=text[l].gTitle;
document.getElementById("tTitle").innerText=text[l].tTitle;
document.getElementById("rTitle").innerText=text[l].rTitle;
}

function saveGuardian(){
let name=gName.value;
let phone=gPhone.value;
if(name=="" || phone==""){
alert("Fill all details");
return;
}
localStorage.setItem("guardian",JSON.stringify({
name,phone
}));
guardianCard.classList.add("hidden");
startTest();
}

function startTest(){
qIndex=0; score=0;
testCard.classList.remove("hidden");
resultCard.classList.add("hidden");
showQuestion();
}

function showQuestion(){
let q=questions[qIndex];
let html=`<p>${q.q[lang]}</p>`;
if(q.img) html+=`<img src="${q.img}">`;
q.options.forEach((o,i)=>{
html+=`<label><input type="radio" name="opt" value="${i}"> ${o}</label><br>`;
});
questionBox.innerHTML=html;
}

function nextQuestion(){
let sel=document.querySelector('input[name="opt"]:checked');
if(!sel){alert("Select answer"); return;}
if(parseInt(sel.value)==questions[qIndex].ans) score++;
qIndex++;
if(qIndex<questions.length) showQuestion();
else finishTest();
}

function finishTest(){
testCard.classList.add("hidden");
resultCard.classList.remove("hidden");

let percent=Math.round((score/10)*100);
scoreText.innerText=`Score: ${percent}%`;

let history=JSON.parse(localStorage.getItem("scores")||"[]");
history.push({date:new Date().toLocaleDateString(),score:percent});
localStorage.setItem("scores",JSON.stringify(history));

if(history.length>1){
let last=history[history.length-2].score;
if(last-percent>=30){
alert("⚠ Alert to Guardian: Sudden decline detected!");
}
}

drawChart(history);
}

function drawChart(data){
let c=document.getElementById("chart");
let ctx=c.getContext("2d");
ctx.clearRect(0,0,300,150);
ctx.beginPath();
ctx.moveTo(10,140);
data.forEach((d,i)=>{
ctx.lineTo(10+i*30,140-d.score);
});
ctx.stroke();
}
</script>
</body>
</html>
